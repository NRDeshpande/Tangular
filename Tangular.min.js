!function(e){function r(){this.commands,this.variables,this.builder,this.split='\0'}if(!e.Tangular){var n={},t=n.helpers={};n.version='v3.0.0',n.cache={},n.debug=!1,e.Ta=e.Tangular=n,e.Thelpers=t;var i=/&&|\|\|/,s=/[a-z0-9._]+/gi,l=/^[a-z0-9$]+/i,a=/^[0-9]/,u=/'.*?'|".?"/g,o=/\{\{.*?\}\}/g,c=/\{\{|\}\}/g,p=/[<>&"]/g,f=/\n$/g;n.toArray=function(e){for(var r=Object.keys(e),n=[],t=0,i=r.length;t<i;t++)n.push({key:r[t],value:e[r[t]]});return n},r.prototype.compile=function(e){var r,n=this,t=0,i=0,s=[];n.variables={},n.commands=[],n.builder=e.replace(o,function(e){var a,u=e.replace(c,'').trim(),o=null,p=null,f=!1,h=!1,d=!0;if('fi'===u)t--;else if('end'===u)i--,s.pop();else if('if '===u.substring(0,3)){if(t++,(o=n.parseVariables(u.substring(3),s)).length)for(b=0;b<o.length;b++){m=o[b];n.variables[m]?n.variables[m]++:n.variables[m]=1}else o=null;f=!0,d=!0}else if('foreach '===u.substring(0,8))i++,r=u.substring(8).split(' '),s.push(r[0].trim()),-1!==(a=r[2].indexOf('.'))&&(r[2]=r[2].substring(0,a)),o=r[2].trim(),-1===s.indexOf(o)?(n.variables[o]?n.variables[o]++:n.variables[o]=1,o=[o]):o=null,h=!0;else if('else if '===u.substring(0,8)){if((o=n.parseVariables(u.substring(8),s)).length)for(b=0;b<o.length;b++){var m=o[b];n.variables[m]?n.variables[m]++:n.variables[m]=1}else o=null;f=!0}else if('continue'!==u&&'break'!==u&&'else'!==u){if((o=u?u.match(l):null)&&(o=o.toString()),o&&-1===s.indexOf(o)?(n.variables[o]?n.variables[o]++:n.variables[o]=1,o=[o]):o=null,-1===u.indexOf('|')&&(u+=' | encode'),p=u.split('|'),u=p[0],(p=p.slice(1)).length)for(var b=0;b<p.length;b++){var g=p[b].trim();g=-1===(a=g.indexOf('('))?'Thelpers.$execute(\''+g+'\', )':'Thelpers.$execute(\''+g.substring(0,a)+'\',,'+g.substring(a+1),p[b]=g}else p=null;u=n.safe(u.trim()||'model'),d=!1}return n.commands.push({index:n.commands.length,cmd:u,ifcount:t,loopcount:i,variable:o,helpers:p,isloop:h,isif:f,iscode:d}),n.split}).split(n.split);for(var a=0,u=n.builder.length;a<u;a++)n.builder[a]=n.builder[a].replace(f,'');return n.make()},r.prototype.parseVariables=function(e,r){for(var n=[],t=e.split(i),l=0,o=t.length;l<o;l++)for(var c=t[l].replace(u,''),p=c.match(s),f=0;f<p.length;f++)(c=(c=p[f]).split('.')[0])&&!a.test(c)&&'null'!==c&&'undefined'!==c&&-1===n.indexOf(c)&&-1===r.indexOf(c)&&n.push(c);return n},r.prototype.safe=function(e){for(var r=e.split('.'),n=[],t=1;t<r.length;t++){var i=r.slice(0,t).join('.');n.push(i+'==null?\'\':')}return n.join('')+r.join('.')},r.prototype.make=function(){for(var e=this,r=['var $output=$text[0];var $tmp;var $index=0;'],n=0,t=e.commands.length;n<t;n++){var i,s=e.commands[n];if(n&&r.push('$output+=$text['+n+'];'),s.iscode)if(s.isloop){var l='$i'+Math.random().toString(16).substring(3,6),a=l+'a';i=s.variable[0],i=a+'='+e.safe(i)+';if(!('+a+' instanceof Array)){if('+a+'&&typeof('+a+')===\'object\')'+a+'=Tangular.toArray('+a+')}if('+a+' instanceof Array&&'+a+'.length){for(var '+l+'=0,'+l+'l='+a+'.length;'+l+'<'+l+'l;'+l+'++){$index='+l+';var '+s.cmd.split(' ')[1]+'='+a+'['+l+'];',r.push(i)}else if(s.isif)'else if '===s.cmd.substring(0,8)?r.push(s.cmd.substring(0,8).trim()+'('+s.cmd.substring(8).trim()+'){'):r.push(s.cmd.substring(0,3).trim()+'('+s.cmd.substring(3).trim()+'){');else switch(s.cmd){case'else':r.push('}else{');break;case'end':r.push('}}');break;case'fi':r.push('}');break;case'break':r.push('break;');break;case'continue':r.push('continue;')}else if(s.helpers){for(var u='',o=0;o<s.helpers.length;o++){var c=s.helpers[o];u=0===o?c.replace('',s.cmd.trim()).trim():c.replace('',u.trim())}r.push('$tmp='+u+';if($tmp!=null)$output+=$tmp;')}else r.push('if('+s.cmd+'!=null)$output+='+s.cmd+';')}r.push('$output+=$text['+e.commands.length+'];returnÂ $output;'),delete e.variables.$;for(var p=Object.keys(e.variables),f=['$ || {}','model'],n=0;n<p.length;n++)f.push('model.'+p[n]);var h='var tangular=function($,model'+(p.length?','+p.join(','):'')+'){'+r.join('')+'};return function(model,$){return tangular('+f.join(',')+');}';return new Function('$text',h)(e.builder)},t.$execute=function(e,r,n,i,s,l,a,u,o){return null==t[e]?(console&&console.warn('Tangular: missing helper','"'+e+'"'),r):t[e].call(this,r,n,i,s,l,a,u,o)},t.encode=function(e){return null==e?'':e.toString().replace(p,function(e){switch(e){case'&':return'&amp;';case'<':return'&lt;';case'>':return'&gt;';case'"':return'&quot;'}return e})},t.raw=function(e){return e},n.render=function(e,n,t){return null==n&&(n={}),(new r).compile(e)(n,t)},n.compile=function(e){return(new r).compile(e)}}}(window);